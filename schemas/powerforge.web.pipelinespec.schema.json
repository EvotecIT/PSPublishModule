{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "powerforge.web.pipelinespec.schema.json",
  "title": "PowerForge Web PipelineSpec (schema v1)",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "$schema": { "type": "string" },
    "SchemaVersion": { "type": "integer", "minimum": 1 },
    "cache": { "type": "boolean" },
    "cachePath": { "type": "string" },
    "profile": { "type": "boolean" },
    "profilePath": { "type": "string" },
    "steps": {
      "type": "array",
      "minItems": 1,
      "items": { "$ref": "#/$defs/PipelineStep" }
    }
  },
  "required": ["steps"],
  "$defs": {
    "PipelineStep": {
      "type": "object",
      "oneOf": [
        { "$ref": "#/$defs/BuildStep" },
        { "$ref": "#/$defs/VerifyStep" },
        { "$ref": "#/$defs/DoctorStep" },
        { "$ref": "#/$defs/MarkdownFixStep" },
        { "$ref": "#/$defs/ApiDocsStep" },
        { "$ref": "#/$defs/ChangelogStep" },
        { "$ref": "#/$defs/LlmsStep" },
        { "$ref": "#/$defs/SitemapStep" },
        { "$ref": "#/$defs/OptimizeStep" },
        { "$ref": "#/$defs/AuditStep" },
        { "$ref": "#/$defs/DotNetBuildStep" },
        { "$ref": "#/$defs/DotNetPublishStep" },
        { "$ref": "#/$defs/OverlayStep" },
        { "$ref": "#/$defs/CloudflareStep" }
      ]
    },
    "BuildStep": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "task": { "const": "build" },
        "id": { "type": "string" },
        "dependsOn": { "oneOf": [{ "type": "string" }, { "type": "array", "items": { "type": "string" } }] },
        "mode": { "type": "string" },
        "modes": { "type": "array", "items": { "type": "string" } },
        "onlyModes": { "type": "array", "items": { "type": "string" } },
        "only-modes": { "type": "array", "items": { "type": "string" } },
        "skipModes": { "type": "array", "items": { "type": "string" } },
        "skip-modes": { "type": "array", "items": { "type": "string" } },
        "config": { "type": "string" },
        "out": { "type": "string" },
        "output": { "type": "string" },
        "clean": {
          "type": "boolean",
          "description": "When true, delete existing output contents before writing new build artifacts."
        }
      },
      "required": ["task", "config", "out"]
    },
    "VerifyStep": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "task": { "const": "verify" },
        "id": { "type": "string" },
        "dependsOn": { "oneOf": [{ "type": "string" }, { "type": "array", "items": { "type": "string" } }] },
        "mode": { "type": "string" },
        "modes": { "type": "array", "items": { "type": "string" } },
        "onlyModes": { "type": "array", "items": { "type": "string" } },
        "only-modes": { "type": "array", "items": { "type": "string" } },
        "skipModes": { "type": "array", "items": { "type": "string" } },
        "skip-modes": { "type": "array", "items": { "type": "string" } },
        "config": { "type": "string" },
        "suppressWarnings": { "type": "array", "items": { "type": "string" } },
        "failOnWarnings": { "type": "boolean" },
        "failOnNavLint": { "type": "boolean" },
        "failOnNavLintWarnings": { "type": "boolean" },
        "failOnThemeContract": { "type": "boolean" },
        "baseline": { "type": "string", "description": "Path to a verify baseline file (relative to pipeline json unless absolute). Must resolve under site root." },
        "baselinePath": { "type": "string", "description": "Alias for baseline." },
        "baselineGenerate": { "type": "boolean", "description": "When true, write the verify baseline file from current warnings." },
        "baselineUpdate": { "type": "boolean", "description": "When true, merge current warnings into an existing verify baseline file." },
        "failOnNewWarnings": { "type": "boolean", "description": "When true, fail only when verify emits warnings not present in baseline." },
        "failOnNew": { "type": "boolean", "description": "Alias for failOnNewWarnings." },
        "warningPreviewCount": { "type": "integer", "minimum": 0, "description": "How many warnings to include in the thrown failure summary (default 2 in dev/fast, 5 otherwise)." },
        "errorPreviewCount": { "type": "integer", "minimum": 0, "description": "How many errors to include in the thrown failure summary (default 2 in dev/fast, 5 otherwise)." }
      },
      "required": ["task", "config"]
    },
    "DoctorStep": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "task": { "const": "doctor" },
        "id": { "type": "string" },
        "dependsOn": { "oneOf": [{ "type": "string" }, { "type": "array", "items": { "type": "string" } }] },
        "mode": { "type": "string" },
        "modes": { "type": "array", "items": { "type": "string" } },
        "onlyModes": { "type": "array", "items": { "type": "string" } },
        "only-modes": { "type": "array", "items": { "type": "string" } },
        "skipModes": { "type": "array", "items": { "type": "string" } },
        "skip-modes": { "type": "array", "items": { "type": "string" } },
        "config": { "type": "string" },
        "siteRoot": { "type": "string" },
        "site-root": { "type": "string" },
        "out": { "type": "string" },
        "output": { "type": "string" },
        "build": { "type": "boolean" },
        "verify": { "type": "boolean" },
        "audit": { "type": "boolean" },
        "noBuild": { "type": "boolean" },
        "noVerify": { "type": "boolean" },
        "noAudit": { "type": "boolean" },
        "suppressWarnings": { "type": "array", "items": { "type": "string" } },
        "failOnWarnings": { "type": "boolean" },
        "failOnNavLint": { "type": "boolean" },
        "failOnNavLintWarnings": { "type": "boolean" },
        "failOnThemeContract": { "type": "boolean" },
        "include": { "type": "string" },
        "exclude": { "type": "string" },
        "maxTotalFiles": { "type": "integer", "minimum": 0, "description": "Maximum allowed total file count under siteRoot (0 disables)." },
        "max-total-files": { "type": "integer", "minimum": 0, "description": "Alias for maxTotalFiles." },
        "suppressIssues": { "type": "array", "items": { "type": "string" }, "description": "Audit issue suppressions (same matching rules as audit step). Supports codes like PFAUDIT.BUDGET plus substring/wildcard/re:... matching." },
        "suppress-issues": { "type": "array", "items": { "type": "string" }, "description": "Alias for suppressIssues." },
        "noDefaultExclude": { "type": "boolean" },
        "ignoreNav": { "type": "string" },
        "ignore-nav": { "type": "string" },
        "noDefaultIgnoreNav": { "type": "boolean" },
        "navSelector": { "type": "string" },
        "nav-selector": { "type": "string" },
        "navRequired": { "type": "boolean" },
        "navOptional": { "type": "boolean" },
        "navIgnorePrefixes": { "type": "string" },
        "nav-ignore-prefixes": { "type": "string" },
        "navIgnorePrefix": { "type": "string" },
        "nav-ignore-prefix": { "type": "string" },
        "navRequiredLinks": { "type": "string" },
        "nav-required-links": { "type": "string" },
        "navRequiredLink": { "type": "string" },
        "nav-required-link": { "type": "string" },
        "navProfiles": { "type": "string" },
        "nav-profiles": { "type": "string" },
        "minNavCoveragePercent": { "type": "integer", "minimum": 0, "maximum": 100 },
        "min-nav-coverage": { "type": "integer", "minimum": 0, "maximum": 100 },
        "requiredRoutes": { "type": "string" },
        "required-routes": { "type": "string" },
        "requiredRoute": { "type": "string" },
        "required-route": { "type": "string" },
        "checkLinks": { "type": "boolean" },
        "checkAssets": { "type": "boolean" },
        "checkNav": { "type": "boolean" },
        "checkTitles": { "type": "boolean" },
        "checkDuplicateIds": { "type": "boolean" },
        "checkHtmlStructure": { "type": "boolean" },
        "summary": { "type": "boolean" },
        "summaryPath": { "type": "string" },
        "summaryMaxIssues": { "type": "integer", "minimum": 0 },
        "sarif": { "type": "boolean" },
        "sarifPath": { "type": "string" },
        "sarif-path": { "type": "string" },
        "navCanonicalPath": { "type": "string" },
        "navCanonical": { "type": "string" },
        "navCanonicalSelector": { "type": "string" },
        "navCanonicalRequired": { "type": "boolean" },
        "checkUtf8": { "type": "boolean" },
        "checkMetaCharset": { "type": "boolean" },
        "checkUnicodeReplacementChars": { "type": "boolean" },
        "checkHeadingOrder": { "type": "boolean" },
        "checkLinkPurposeConsistency": { "type": "boolean" },
        "checkLinkPurpose": { "type": "boolean" },
        "checkNetworkHints": { "type": "boolean" },
        "checkRenderBlockingResources": { "type": "boolean" },
        "checkRenderBlocking": { "type": "boolean" },
        "maxHeadBlockingResources": { "type": "integer", "minimum": 0 },
        "max-head-blocking": { "type": "integer", "minimum": 0 },
        "errorPreviewCount": { "type": "integer", "minimum": 0 },

        "verifyBaseline": { "type": "string", "description": "Path to a verify baseline file used by the embedded verify run. Must resolve under site root." },
        "verifyBaselinePath": { "type": "string", "description": "Alias for verifyBaseline." },
        "verifyBaselineGenerate": { "type": "boolean", "description": "When true, write the verify baseline file from current verify warnings." },
        "verifyBaselineUpdate": { "type": "boolean", "description": "When true, merge current verify warnings into an existing baseline file." },
        "verifyFailOnNewWarnings": { "type": "boolean", "description": "When true, fail only when verify emits warnings not present in baseline." },
        "verifyFailOnNew": { "type": "boolean", "description": "Alias for verifyFailOnNewWarnings." },
        "verifyWarningPreviewCount": { "type": "integer", "minimum": 0, "description": "How many verify warnings to include in the thrown failure summary (default 2 in dev/fast, 5 otherwise)." },
        "verifyErrorPreviewCount": { "type": "integer", "minimum": 0, "description": "How many verify errors to include in the thrown failure summary (default 2 in dev/fast, 5 otherwise)." }
      },
      "required": ["task", "config"]
    },
    "MarkdownFixStep": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "task": { "const": "markdown-fix" },
        "id": { "type": "string" },
        "dependsOn": { "oneOf": [{ "type": "string" }, { "type": "array", "items": { "type": "string" } }] },
        "mode": { "type": "string" },
        "modes": { "type": "array", "items": { "type": "string" } },
        "onlyModes": { "type": "array", "items": { "type": "string" } },
        "only-modes": { "type": "array", "items": { "type": "string" } },
        "skipModes": { "type": "array", "items": { "type": "string" } },
        "skip-modes": { "type": "array", "items": { "type": "string" } },
        "config": { "type": "string" },
        "root": { "type": "string" },
        "path": { "type": "string" },
        "siteRoot": { "type": "string" },
        "include": { "type": "string" },
        "exclude": { "type": "string" },
        "apply": { "type": "boolean" }
      },
      "required": ["task"]
    },
    "CloudflareStep": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "task": { "const": "cloudflare" },
        "id": { "type": "string" },
        "dependsOn": { "oneOf": [{ "type": "string" }, { "type": "array", "items": { "type": "string" } }] },
        "mode": { "type": "string" },
        "modes": { "type": "array", "items": { "type": "string" } },
        "onlyModes": { "type": "array", "items": { "type": "string" } },
        "only-modes": { "type": "array", "items": { "type": "string" } },
        "skipModes": { "type": "array", "items": { "type": "string" } },
        "skip-modes": { "type": "array", "items": { "type": "string" } },

        "zoneId": { "type": "string" },
        "zone-id": { "type": "string" },
        "tokenEnv": { "type": "string", "description": "Env var name containing a Cloudflare API token (recommended). Defaults to CLOUDFLARE_API_TOKEN." },
        "token-env": { "type": "string", "description": "Alias for tokenEnv." },
        "token": { "type": "string", "description": "Inline API token (discouraged; prefer tokenEnv and CI secrets)." },
        "baseUrl": { "type": "string", "description": "Base URL used to combine with paths (required when using paths)." },
        "base-url": { "type": "string", "description": "Alias for baseUrl." },
        "paths": { "type": "string", "description": "Comma-separated paths to purge (combined with baseUrl)." },
        "path": { "type": "string", "description": "Alias for paths." },
        "urls": { "type": "string", "description": "Comma-separated full URLs to purge." },
        "url": { "type": "string", "description": "Alias for urls." },
        "purgeEverything": { "type": "boolean" },
        "purge-everything": { "type": "boolean" },
        "dryRun": { "type": "boolean" },
        "dry-run": { "type": "boolean" }
      },
      "required": ["task"],
      "anyOf": [
        { "required": ["zoneId"] },
        { "required": ["zone-id"] }
      ]
    },
    "ApiDocsStep": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "task": { "const": "apidocs" },
        "id": { "type": "string" },
        "dependsOn": { "oneOf": [{ "type": "string" }, { "type": "array", "items": { "type": "string" } }] },
        "mode": { "type": "string" },
        "modes": { "type": "array", "items": { "type": "string" } },
        "onlyModes": { "type": "array", "items": { "type": "string" } },
        "only-modes": { "type": "array", "items": { "type": "string" } },
        "skipModes": { "type": "array", "items": { "type": "string" } },
        "skip-modes": { "type": "array", "items": { "type": "string" } },
        "config": { "type": "string" },
        "type": { "type": "string", "enum": ["CSharp", "PowerShell"] },
        "xml": { "type": "string" },
        "help": { "type": "string" },
        "helpPath": { "type": "string" },
        "assembly": { "type": "string" },
        "out": { "type": "string" },
        "output": { "type": "string" },
        "title": { "type": "string" },
        "baseUrl": { "type": "string" },
        "format": { "type": "string", "enum": ["json", "hybrid", "html", "both"] },
        "css": { "type": "string" },
        "criticalCss": { "type": "string", "description": "Path to a critical CSS file to inline into API pages." },
        "critical-css": { "type": "string", "description": "Path to a critical CSS file to inline into API pages." },
        "criticalCssPath": { "type": "string", "description": "Path to a critical CSS file to inline into API pages." },
        "critical-css-path": { "type": "string", "description": "Path to a critical CSS file to inline into API pages." },
        "injectCriticalCss": { "type": "boolean", "description": "When true and config is provided, inline assetRegistry.criticalCss from site.json into API pages." },
        "inject-critical-css": { "type": "boolean", "description": "When true and config is provided, inline assetRegistry.criticalCss from site.json into API pages." },
        "headerHtml": { "type": "string" },
        "footerHtml": { "type": "string" },
        "template": { "type": "string" },
        "templateRoot": { "type": "string" },
        "templateIndex": { "type": "string" },
        "templateType": { "type": "string" },
        "templateDocsIndex": { "type": "string" },
        "templateDocsType": { "type": "string" },
        "docsScript": { "type": "string" },
        "searchScript": { "type": "string" },
          "docsHome": { "type": "string" },
          "docsHomeUrl": { "type": "string" },
          "sidebar": { "type": "string", "enum": ["left", "right"] },
          "sidebarPosition": { "type": "string", "enum": ["left", "right"] },
          "bodyClass": { "type": "string" },
          "body-class": { "type": "string" },
          "sourceRoot": { "type": "string" },
        "sourceUrl": { "type": "string" },
        "includeUndocumented": { "type": "boolean" },
        "nav": { "type": "string" },
        "navJson": { "type": "string" },
        "navContextPath": { "type": "string" },
        "navContextCollection": { "type": "string" },
        "navContextLayout": { "type": "string" },
        "navContextProject": { "type": "string" },
        "siteName": { "type": "string" },
        "brandUrl": { "type": "string" },
        "brandIcon": { "type": "string" },
        "includeNamespace": { "type": "string" },
        "excludeNamespace": { "type": "string" },
        "includeType": { "type": "string" },
        "excludeType": { "type": "string" },
        "quickStartTypes": { "type": "string", "description": "Comma-separated type names used for the API Quick Start / Main API sections." },
        "quickstartTypes": { "type": "string", "description": "Alias of quickStartTypes." },
        "quick-start-types": { "type": "string", "description": "Alias of quickStartTypes." },
        "quickstart-types": { "type": "string", "description": "Alias of quickStartTypes." },
        "generateCoverageReport": { "type": "boolean", "description": "Generate API coverage report JSON." },
        "generate-coverage-report": { "type": "boolean", "description": "Alias of generateCoverageReport." },
        "coverageReport": { "type": "string", "description": "Coverage report output path (relative to pipeline config or absolute)." },
        "coverage-report": { "type": "string", "description": "Alias of coverageReport." },
        "coverageReportPath": { "type": "string", "description": "Alias of coverageReport." },
        "coverage-report-path": { "type": "string", "description": "Alias of coverageReport." },
        "generatePowerShellFallbackExamples": { "type": "boolean", "description": "Generate fallback code examples for PowerShell commands when help XML has no examples." },
        "generate-powershell-fallback-examples": { "type": "boolean", "description": "Alias of generatePowerShellFallbackExamples." },
        "psExamplesPath": { "type": "string", "description": "Path to PowerShell example scripts file/folder used for fallback snippets." },
        "ps-examples-path": { "type": "string", "description": "Alias of psExamplesPath." },
        "powerShellExamplesPath": { "type": "string", "description": "Alias of psExamplesPath." },
        "powershell-examples-path": { "type": "string", "description": "Alias of psExamplesPath." },
        "powerShellFallbackExampleLimit": { "type": "integer", "minimum": 1, "maximum": 5, "description": "Max fallback examples per PowerShell command." },
        "powershell-fallback-example-limit": { "type": "integer", "minimum": 1, "maximum": 5, "description": "Alias of powerShellFallbackExampleLimit." },
        "failOnWarnings": { "type": "boolean" },
        "failOnCoverage": { "type": "boolean", "description": "Fail apidocs step when configured coverage thresholds are not met." },
        "fail-on-coverage": { "type": "boolean", "description": "Alias of failOnCoverage." },
        "coveragePreviewCount": { "type": "integer", "minimum": 0, "description": "How many failed coverage metrics to preview in logs." },
        "coverage-preview": { "type": "integer", "minimum": 0, "description": "Alias of coveragePreviewCount." },
        "minTypeSummaryPercent": { "type": "number", "minimum": 0, "maximum": 100 },
        "min-type-summary-percent": { "type": "number", "minimum": 0, "maximum": 100 },
        "minTypeRemarksPercent": { "type": "number", "minimum": 0, "maximum": 100 },
        "min-type-remarks-percent": { "type": "number", "minimum": 0, "maximum": 100 },
        "minTypeCodeExamplesPercent": { "type": "number", "minimum": 0, "maximum": 100 },
        "min-type-code-examples-percent": { "type": "number", "minimum": 0, "maximum": 100 },
        "minMemberSummaryPercent": { "type": "number", "minimum": 0, "maximum": 100 },
        "min-member-summary-percent": { "type": "number", "minimum": 0, "maximum": 100 },
        "minMemberCodeExamplesPercent": { "type": "number", "minimum": 0, "maximum": 100 },
        "min-member-code-examples-percent": { "type": "number", "minimum": 0, "maximum": 100 },
        "minPowerShellSummaryPercent": { "type": "number", "minimum": 0, "maximum": 100 },
        "min-powershell-summary-percent": { "type": "number", "minimum": 0, "maximum": 100 },
        "minPowerShellRemarksPercent": { "type": "number", "minimum": 0, "maximum": 100 },
        "min-powershell-remarks-percent": { "type": "number", "minimum": 0, "maximum": 100 },
        "minPowerShellCodeExamplesPercent": { "type": "number", "minimum": 0, "maximum": 100 },
        "min-powershell-code-examples-percent": { "type": "number", "minimum": 0, "maximum": 100 },
        "minPowerShellParameterSummaryPercent": { "type": "number", "minimum": 0, "maximum": 100 },
        "min-powershell-parameter-summary-percent": { "type": "number", "minimum": 0, "maximum": 100 },
        "minTypeSourcePathPercent": { "type": "number", "minimum": 0, "maximum": 100 },
        "min-type-source-path-percent": { "type": "number", "minimum": 0, "maximum": 100 },
        "minTypeSourceUrlPercent": { "type": "number", "minimum": 0, "maximum": 100 },
        "min-type-source-url-percent": { "type": "number", "minimum": 0, "maximum": 100 },
        "minMemberSourcePathPercent": { "type": "number", "minimum": 0, "maximum": 100 },
        "min-member-source-path-percent": { "type": "number", "minimum": 0, "maximum": 100 },
        "minMemberSourceUrlPercent": { "type": "number", "minimum": 0, "maximum": 100 },
        "min-member-source-url-percent": { "type": "number", "minimum": 0, "maximum": 100 },
        "minPowerShellSourcePathPercent": { "type": "number", "minimum": 0, "maximum": 100 },
        "min-powershell-source-path-percent": { "type": "number", "minimum": 0, "maximum": 100 },
        "minPowerShellSourceUrlPercent": { "type": "number", "minimum": 0, "maximum": 100 },
        "min-powershell-source-url-percent": { "type": "number", "minimum": 0, "maximum": 100 },
        "maxTypeSourceInvalidUrlCount": { "type": "number", "minimum": 0 },
        "max-type-source-invalid-url-count": { "type": "number", "minimum": 0 },
        "maxMemberSourceInvalidUrlCount": { "type": "number", "minimum": 0 },
        "max-member-source-invalid-url-count": { "type": "number", "minimum": 0 },
        "maxPowerShellSourceInvalidUrlCount": { "type": "number", "minimum": 0 },
        "max-powershell-source-invalid-url-count": { "type": "number", "minimum": 0 },
        "maxTypeSourceUnresolvedTemplateCount": { "type": "number", "minimum": 0 },
        "max-type-source-unresolved-template-count": { "type": "number", "minimum": 0 },
        "maxMemberSourceUnresolvedTemplateCount": { "type": "number", "minimum": 0 },
        "max-member-source-unresolved-template-count": { "type": "number", "minimum": 0 },
        "maxPowerShellSourceUnresolvedTemplateCount": { "type": "number", "minimum": 0 },
        "max-powershell-source-unresolved-template-count": { "type": "number", "minimum": 0 },
        "maxTypeSourceRepoMismatchHints": { "type": "number", "minimum": 0 },
        "max-type-source-repo-mismatch-hints": { "type": "number", "minimum": 0 },
        "maxMemberSourceRepoMismatchHints": { "type": "number", "minimum": 0 },
        "max-member-source-repo-mismatch-hints": { "type": "number", "minimum": 0 },
        "maxPowerShellSourceRepoMismatchHints": { "type": "number", "minimum": 0 },
        "max-powershell-source-repo-mismatch-hints": { "type": "number", "minimum": 0 },
        "suppressWarnings": { "type": "array", "items": { "type": "string" } },
        "warningPreviewCount": { "type": "integer", "minimum": 0 }
      },
      "required": ["task", "out"]
    },
    "ChangelogStep": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "task": { "const": "changelog" },
        "id": { "type": "string" },
        "dependsOn": { "oneOf": [{ "type": "string" }, { "type": "array", "items": { "type": "string" } }] },
        "mode": { "type": "string" },
        "modes": { "type": "array", "items": { "type": "string" } },
        "onlyModes": { "type": "array", "items": { "type": "string" } },
        "only-modes": { "type": "array", "items": { "type": "string" } },
        "skipModes": { "type": "array", "items": { "type": "string" } },
        "skip-modes": { "type": "array", "items": { "type": "string" } },
        "source": { "type": "string", "enum": ["Auto", "File", "GitHub"] },
        "changelog": { "type": "string" },
        "changelogPath": { "type": "string" },
        "repo": { "type": "string" },
        "repoUrl": { "type": "string" },
        "token": { "type": "string" },
        "max": { "type": ["string", "integer"] },
        "title": { "type": "string" },
        "out": { "type": "string" },
        "output": { "type": "string" }
      },
      "required": ["task", "out"]
    },
    "LlmsStep": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "task": { "const": "llms" },
        "id": { "type": "string" },
        "dependsOn": { "oneOf": [{ "type": "string" }, { "type": "array", "items": { "type": "string" } }] },
        "mode": { "type": "string" },
        "modes": { "type": "array", "items": { "type": "string" } },
        "onlyModes": { "type": "array", "items": { "type": "string" } },
        "only-modes": { "type": "array", "items": { "type": "string" } },
        "skipModes": { "type": "array", "items": { "type": "string" } },
        "skip-modes": { "type": "array", "items": { "type": "string" } },
        "siteRoot": { "type": "string" },
        "project": { "type": "string" },
        "apiIndex": { "type": "string" },
        "apiBase": { "type": "string" },
        "name": { "type": "string" },
        "package": { "type": "string" },
        "packageId": { "type": "string" },
        "version": { "type": "string" },
        "quickstart": { "type": "string" },
        "overview": { "type": "string" },
        "license": { "type": "string" },
        "targets": { "type": "string" },
        "extra": { "type": "string" },
        "apiLevel": { "type": "string", "enum": ["None", "Summary", "Full"] },
        "apiMaxTypes": { "type": "integer", "minimum": 0 },
        "apiMaxMembers": { "type": "integer", "minimum": 0 }
      },
      "required": ["task", "siteRoot"]
    },
    "SitemapStep": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "task": { "const": "sitemap" },
        "id": { "type": "string" },
        "dependsOn": { "oneOf": [{ "type": "string" }, { "type": "array", "items": { "type": "string" } }] },
        "mode": { "type": "string" },
        "modes": { "type": "array", "items": { "type": "string" } },
        "onlyModes": { "type": "array", "items": { "type": "string" } },
        "only-modes": { "type": "array", "items": { "type": "string" } },
        "skipModes": { "type": "array", "items": { "type": "string" } },
        "skip-modes": { "type": "array", "items": { "type": "string" } },
        "siteRoot": { "type": "string" },
        "baseUrl": { "type": "string" },
        "apiSitemap": { "type": "string" },
        "out": { "type": "string" },
        "output": { "type": "string" },
        "entries": { "type": "array", "items": { "$ref": "#/$defs/SitemapEntry" } },
        "includeHtmlFiles": { "type": "boolean" },
        "includeTextFiles": { "type": "boolean" },
        "extraPaths": { "type": "array", "items": { "type": "string" } },
        "html": { "type": "boolean" },
        "htmlOutput": { "type": "string" },
        "htmlOut": { "type": "string" },
        "htmlTemplate": { "type": "string" },
        "htmlCss": { "type": "string" },
        "htmlTitle": { "type": "string" }
      },
      "required": ["task", "siteRoot", "baseUrl"]
    },
    "OptimizeStep": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "task": { "const": "optimize" },
        "id": { "type": "string" },
        "dependsOn": { "oneOf": [{ "type": "string" }, { "type": "array", "items": { "type": "string" } }] },
        "mode": { "type": "string" },
        "modes": { "type": "array", "items": { "type": "string" } },
        "onlyModes": { "type": "array", "items": { "type": "string" } },
        "only-modes": { "type": "array", "items": { "type": "string" } },
        "skipModes": { "type": "array", "items": { "type": "string" } },
        "skip-modes": { "type": "array", "items": { "type": "string" } },
        "siteRoot": { "type": "string" },
        "config": { "type": "string" },
        "criticalCss": { "type": "string" },
        "cssPattern": { "type": "string" },
        "minifyHtml": { "type": "boolean" },
        "minifyCss": { "type": "boolean" },
        "minifyJs": { "type": "boolean" },
        "htmlInclude": { "type": "array", "items": { "type": "string" } },
        "html-include": { "type": "array", "items": { "type": "string" } },
        "htmlExclude": { "type": "array", "items": { "type": "string" } },
        "html-exclude": { "type": "array", "items": { "type": "string" } },
        "maxHtmlFiles": { "type": "integer", "minimum": 0 },
        "max-html-files": { "type": "integer", "minimum": 0 },
        "scopeFromBuildUpdated": {
          "type": "boolean",
          "description": "When true, if htmlInclude/html-include is not set, scope HTML processing to the HTML files updated by the most recent build step (when siteRoot matches build out). In --fast mode this behavior is enabled by default; set this to false to disable."
        },
        "scope-from-build-updated": { "type": "boolean" },
        "optimizeImages": { "type": "boolean" },
        "images": { "type": "boolean" },
        "imageExtensions": { "type": "array", "items": { "type": "string" } },
        "image-ext": { "type": "array", "items": { "type": "string" } },
        "imageInclude": { "type": "array", "items": { "type": "string" } },
        "image-include": { "type": "array", "items": { "type": "string" } },
        "imageExclude": { "type": "array", "items": { "type": "string" } },
        "image-exclude": { "type": "array", "items": { "type": "string" } },
        "imageQuality": { "type": "integer", "minimum": 1, "maximum": 100 },
        "image-quality": { "type": "integer", "minimum": 1, "maximum": 100 },
        "imageStripMetadata": { "type": "boolean" },
        "image-strip-metadata": { "type": "boolean" },
        "imageGenerateWebp": { "type": "boolean" },
        "image-generate-webp": { "type": "boolean" },
        "imageGenerateAvif": { "type": "boolean" },
        "image-generate-avif": { "type": "boolean" },
        "imagePreferNextGen": { "type": "boolean" },
        "image-prefer-nextgen": { "type": "boolean" },
        "imageWidths": { "type": "array", "items": { "type": "integer", "minimum": 1 } },
        "image-widths": { "type": "array", "items": { "type": "integer", "minimum": 1 } },
        "imageEnhanceTags": { "type": "boolean" },
        "image-enhance-tags": { "type": "boolean" },
        "imageMaxBytesPerFile": { "type": "integer", "minimum": 0 },
        "image-max-bytes": { "type": "integer", "minimum": 0 },
        "imageMaxTotalBytes": { "type": "integer", "minimum": 0 },
        "image-max-total-bytes": { "type": "integer", "minimum": 0 },
        "imageFailOnBudget": { "type": "boolean" },
        "image-fail-on-budget": { "type": "boolean" },
        "imageFailOnFailures": { "type": "boolean" },
        "image-fail-on-failures": { "type": "boolean" },
        "imageFailOnErrors": { "type": "boolean" },
        "image-fail-on-errors": { "type": "boolean" },
        "hashAssets": { "type": "boolean" },
        "hashExtensions": { "type": "array", "items": { "type": "string" } },
        "hashExclude": { "type": "array", "items": { "type": "string" } },
        "hashManifest": { "type": "string" },
        "reportPath": { "type": "string" },
        "report-path": { "type": "string" },
        "cacheHeaders": { "type": "boolean" },
        "cacheHeadersOut": { "type": "string" },
        "cacheHeadersHtml": { "type": "string" },
        "cacheHeadersAssets": { "type": "string" },
        "cacheHeadersPaths": { "type": "array", "items": { "type": "string" } }
      },
      "required": ["task", "siteRoot"]
    },
    "AuditStep": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "task": { "const": "audit" },
        "id": { "type": "string" },
        "dependsOn": { "oneOf": [{ "type": "string" }, { "type": "array", "items": { "type": "string" } }] },
        "mode": { "type": "string" },
        "modes": { "type": "array", "items": { "type": "string" } },
        "onlyModes": { "type": "array", "items": { "type": "string" } },
        "only-modes": { "type": "array", "items": { "type": "string" } },
        "skipModes": { "type": "array", "items": { "type": "string" } },
        "skip-modes": { "type": "array", "items": { "type": "string" } },
        "siteRoot": { "type": "string" },
        "include": { "type": "string" },
        "exclude": { "type": "string" },
        "budgetExclude": { "type": "string", "description": "Comma-separated glob patterns to exclude from budget counters (for example api/**). Does not affect the HTML audit scope." },
        "budget-exclude": { "type": "string", "description": "Alias for budgetExclude." },
        "maxHtmlFiles": { "type": "integer", "minimum": 0 },
        "max-html-files": { "type": "integer", "minimum": 0 },
        "maxTotalFiles": { "type": "integer", "minimum": 0, "description": "Maximum allowed total file count under siteRoot (0 disables)." },
        "max-total-files": { "type": "integer", "minimum": 0, "description": "Alias for maxTotalFiles." },
        "scopeFromBuildUpdated": {
          "type": "boolean",
          "description": "When true, if include is not set, scope the audit to the HTML files updated by the most recent build step (when siteRoot matches build out). In --fast mode this behavior is enabled by default; set this to false to disable."
        },
        "scope-from-build-updated": { "type": "boolean" },
        "noDefaultExclude": { "type": "boolean" },
        "ignoreNav": { "type": "string" },
        "noDefaultIgnoreNav": { "type": "boolean" },
        "navSelector": { "type": "string" },
        "navRequired": { "type": "boolean" },
        "navOptional": { "type": "boolean" },
        "navIgnorePrefixes": { "type": "string" },
        "navRequiredLinks": {
          "type": "string",
          "description": "Comma-separated list of links that must exist in each audited nav."
        },
        "navRequiredLink": {
          "type": "string",
          "description": "Deprecated alias for navRequiredLinks."
        },
        "minNavCoveragePercent": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100
        },
        "min-nav-coverage": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100
        },
        "requiredRoutes": {
          "type": "string",
          "description": "Comma-separated list of routes that must resolve in generated output."
        },
        "required-routes": {
          "type": "string",
          "description": "Deprecated alias for requiredRoutes."
        },
        "requiredRoute": {
          "type": "string",
          "description": "Deprecated alias for requiredRoutes."
        },
        "required-route": {
          "type": "string",
          "description": "Deprecated alias for requiredRoutes."
        },
        "checkLinks": { "type": "boolean" },
        "checkAssets": { "type": "boolean" },
        "checkNav": { "type": "boolean" },
        "checkTitles": { "type": "boolean" },
        "checkDuplicateIds": { "type": "boolean" },
        "checkHtmlStructure": { "type": "boolean" },
        "rendered": { "type": "boolean" },
        "renderedEngine": { "type": "string" },
        "renderedEnsureInstalled": { "type": "boolean" },
        "renderedHeadless": { "type": "boolean" },
        "renderedBaseUrl": { "type": "string" },
        "renderedHost": { "type": "string" },
        "renderedPort": { "type": "integer", "minimum": 0 },
        "renderedServe": { "type": "boolean" },
        "renderedMaxPages": { "type": "integer", "minimum": 0 },
        "renderedTimeoutMs": { "type": "integer", "minimum": 0 },
        "renderedCheckConsoleErrors": { "type": "boolean" },
        "renderedCheckConsoleWarnings": { "type": "boolean" },
        "renderedCheckFailedRequests": { "type": "boolean" },
        "renderedInclude": { "type": "string" },
        "renderedExclude": { "type": "string" },
        "summary": { "type": "boolean" },
        "summaryPath": { "type": "string" },
        "summaryMaxIssues": { "type": "integer", "minimum": 0 },
        "baselinePath": { "type": "string" },
        "baseline": { "type": "string" },
        "failOnWarnings": { "type": "boolean" },
        "failOnNewIssues": { "type": "boolean" },
        "failOnNew": { "type": "boolean" },
        "maxErrors": { "type": "integer" },
        "maxWarnings": { "type": "integer" },
        "failOnCategories": { "type": "string" },
        "failCategories": { "type": "string" },
        "navCanonicalPath": { "type": "string" },
        "navCanonical": { "type": "string" },
        "navCanonicalSelector": { "type": "string" },
        "navCanonicalRequired": { "type": "boolean" },
        "checkUtf8": { "type": "boolean" },
        "checkMetaCharset": { "type": "boolean" },
        "checkUnicodeReplacementChars": { "type": "boolean" },
        "suppressIssues": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Issue suppressions (do not emit, do not count, do not gate). Supports codes like PFAUDIT.BUDGET plus substring/wildcard/re:... matching."
        },
        "suppress-issues": { "type": "array", "items": { "type": "string" }, "description": "Alias for suppressIssues." },
        "baselineGenerate": { "type": "boolean" },
        "baselineUpdate": { "type": "boolean" }
      },
      "required": ["task", "siteRoot"]
    },
    "DotNetBuildStep": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "task": { "const": "dotnet-build" },
        "id": { "type": "string" },
        "dependsOn": { "oneOf": [{ "type": "string" }, { "type": "array", "items": { "type": "string" } }] },
        "mode": { "type": "string" },
        "modes": { "type": "array", "items": { "type": "string" } },
        "onlyModes": { "type": "array", "items": { "type": "string" } },
        "only-modes": { "type": "array", "items": { "type": "string" } },
        "skipModes": { "type": "array", "items": { "type": "string" } },
        "skip-modes": { "type": "array", "items": { "type": "string" } },
        "project": { "type": "string" },
        "configuration": { "type": "string" },
        "framework": { "type": "string" },
        "runtime": { "type": "string" },
        "noRestore": { "type": "boolean" }
      },
      "required": ["task", "project"]
    },
    "DotNetPublishStep": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "task": { "const": "dotnet-publish" },
        "id": { "type": "string" },
        "dependsOn": { "oneOf": [{ "type": "string" }, { "type": "array", "items": { "type": "string" } }] },
        "mode": { "type": "string" },
        "modes": { "type": "array", "items": { "type": "string" } },
        "onlyModes": { "type": "array", "items": { "type": "string" } },
        "only-modes": { "type": "array", "items": { "type": "string" } },
        "skipModes": { "type": "array", "items": { "type": "string" } },
        "skip-modes": { "type": "array", "items": { "type": "string" } },
        "project": { "type": "string" },
        "out": { "type": "string" },
        "output": { "type": "string" },
        "configuration": { "type": "string" },
        "framework": { "type": "string" },
        "runtime": { "type": "string" },
        "clean": {
          "type": "boolean",
          "description": "When true, clear dotnet publish output to prevent stale files from previous runs."
        },
        "selfContained": { "type": "boolean" },
        "noBuild": { "type": "boolean" },
        "noRestore": { "type": "boolean" },
        "baseHref": { "type": "string" },
        "defineConstants": { "type": "string" },
        "noBlazorFixes": { "type": "boolean" }
      },
      "required": ["task", "project", "out"]
    },
    "OverlayStep": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "task": { "const": "overlay" },
        "id": { "type": "string" },
        "dependsOn": { "oneOf": [{ "type": "string" }, { "type": "array", "items": { "type": "string" } }] },
        "mode": { "type": "string" },
        "modes": { "type": "array", "items": { "type": "string" } },
        "onlyModes": { "type": "array", "items": { "type": "string" } },
        "only-modes": { "type": "array", "items": { "type": "string" } },
        "skipModes": { "type": "array", "items": { "type": "string" } },
        "skip-modes": { "type": "array", "items": { "type": "string" } },
        "source": { "type": "string" },
        "destination": { "type": "string" },
        "clean": { "type": "boolean" },
        "include": { "type": "string" },
        "exclude": { "type": "string" }
      },
      "required": ["task", "source", "destination"]
    },
    "SitemapEntry": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "path": { "type": "string" },
        "route": { "type": "string" },
        "url": { "type": "string" },
        "priority": { "type": "string" },
        "changefreq": { "type": "string" },
        "changeFrequency": { "type": "string" },
        "lastmod": { "type": "string" },
        "lastModified": { "type": "string" }
      }
    }
  }
}
